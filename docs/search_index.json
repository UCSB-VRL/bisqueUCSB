[["intro.html", "1 BisQue Cloud Service", " 1 BisQue Cloud Service Homepage of BisQue. The landing page of BisQue enables users to interact with sample datasets and view the current analysis modules implemented today. BisQue is a web-based platform specifically designed to provide researchers with organizational and quantitative analysis tools for 5D image data. Users can extend Bisque with both data model and analysis extensions in order to adapt the system to local needs. Bisque’s extensibility stems from two core concepts: flexible metadata facility and an open web-based architecture. Together these empower researchers to create, develop and share novel bioimage analyses. Bisque is implemented as a scalable and modular web-service architecture. Image Servers store and manipulate images. Data servers provide flexible metadata storage. Execution servers house executable modules. The client-server architecture seamlessly integrates services across storage and processing hardware. Communication between various components is performed in a RESTful manner through HTTP requests carrying XML and JSON. Web clients use dynamic web components built with AJAX. Backends seamlessly provide access to local resources as well as large scalable resources like Amazon S3 or iRODS for data storage or Condor grids for computation. "],["how-to-login-or-create-a-new-user.html", "1.1 How to Login or Create a New User", " 1.1 How to Login or Create a New User Homepage of BisQue. The landing page of BisQue enables users to interact with sample datasets and view the current analysis modules implemented today. The top right hand corner shows a drop down to Login or Register New User. Login or Create an Account. After clicking on one of the two options from the dropdown menu above, you will be directed to one of two pages. "],["how-to-upload-data.html", "1.2 How to Upload Data", " 1.2 How to Upload Data Upload over 200+ Supported File Formats. Step 1. Login Make sure you are logged in. If you are logged in, the MENU bar will include Upload. Step 2. Upload File or Folder Click Upload from the toolbar. There will be two options: Choose File or Choose Directory. Step 3. Build a Dataset Selecting Choose Directory will upload all files in that directory. For example, we selected a folder with three NIFTI files. Uploading a Folder. Once the upload is finished, there will be two options to create a new dataset or add to an existing dataset. Progress of Uploading a Folder. Add to New Dataset If we choose to Add a New Dataset, this means we will create a new dataset with these three files we uploaded. We can always add new data to this dataset later. Creating a New Dataset. Add to Existing Dataset If we choose Add to Existing Dataset, this means we will add these three NIFTI files to an existing dataset on BisQue. We are prompted with all of the datasets we have access to on BisQue: Datasets we created and Datasets other users have created but have made public. Adding to an Existing Dataset. Step 4. Setting Permissions Once we have uploaded the data, we can set permissions for who can access our data. By default, everything is uploaded as Private. If we want to make our data publically available, we can Toggle Permissions. Toggle Permissions. "],["how-to-add-annotations.html", "1.3 How to Add Annotations", " 1.3 How to Add Annotations Overview Metadata plays a vital role in interpretation, querying, and analysis of images. For example, an experimental condition may highlight differences between images, image resolution may be needed to detect abnormally sized cells and experimenter comments may be handy in finding images of interest. There are many different types of metadata that may be associated with an image such as textual annotations, image-based object outlines and statistical distributions. In order to store the many types of annotations, we use tagging or hierarchical name–value pairs. Flexible and hierarchical tagging is a key feature of Bisque that enables the user to rapidly model diverse experimental information. "],["how-to-run-a-module.html", "1.4 How to Run a Module", " 1.4 How to Run a Module Running the MetaData Module The Metadata module is a very simple example that annotates an image with its embedded metadata. Refresh the page, go to Analyze and select Metadata module there. Select a single image for test. Execute Run command and observe the updates in the results section "],["imagej-module.html", "1.5 ImageJ Module", " 1.5 ImageJ Module Overview The ImageJ module allows users to execute arbitrary ImageJ macros on single images or datasets of images. Macro parameters can be changed and parameter value lists can be provided to experiment with parameter variations. The results are stored back in BisQue as Gobjects, tables, or images. Uploading of ImageJ Pipelines Most ImageJ macros can be uploaded and used directly with minor modifications. In order to upload a macro, click “Upload”, select the macro file, and click “Upload”. If the file extension is “.ijm”, the file will automatically be recognized as a CellProfiler macro. As an example, we upload the CometAssay macro developed at the Microscopy Services Laboratory of the University of North Carolina at Chapel Hill, Comet Assay. In order to verify the macro, it can be opened by browsing the imagej_pipeline resources and opening the recently uploaded macro. It will look like this: ImageJ Pipeline Each box represents one ImageJ macro step and the arrows indicate the flow through the steps. Note that some boxes have different colors. For example, the “waitForUser” and “Dialog”-related boxes are shown in red to indicate that they are incompatible with BisQue and will render the macro non-executable. Green boxes indicate regular ImageJ steps that were kept unchanged. Blue boxes are BisQue specific steps (such as “load image from BisQue” or “store table to BisQue”). In order to execute the pipeline, we need to fix the red boxes and then re-upload the pipeline. In this example, the first red boxes correspond to the waitForUser steps of the macro: waitForUser(&quot;Draw an oval around the comet head; Click OK&quot;); run(&quot;Measure&quot;); waitForUser(&quot;Draw an oval around the comet tail; Click OK&quot;); run(&quot;Measure&quot;); Since BisQue modules are currently not interactive, such steps are not allowed. However, since they request user-defined regions for head and tail of the comet to analyze, we can replace them with BisQueLoadPolygon steps: BisQueLoadPolygon(&quot;head&quot;); run(&quot;Measure&quot;); BisQueLoadPolygon(&quot;tail&quot;); run(&quot;Measure&quot;); Each BisQueLoadPolygon step searches for a polygon Gobject in the current image and returns it as an ImageJ selection. The other red boxes correspond to ImageJ “Dialog” functions: Dialog.create(&quot;Do Another?&quot;); Dialog.addCheckbox(&quot;Yes&quot;, true); Dialog.show(); Again, since BisQue is not interactive, these are not allowed. In this example, these steps check if the user wants to analyze more comets. For simplicity, we will simply remove these steps and end the analysis after one iteration. This addresses all red boxes but before being able to run the macro in BisQue, we need to add two important steps: the input and output. For the input, we can just add a new step at the very beginning: BisQueLoadImage(); This will load the current image of the module execution into ImageJ for analysis. Note that for larger datasets of images, the macro will be executed once for each image. For the output, we will store the comet analysis results as a table back into BisQue. This is achieved by adding the following line at the end of the macro: BisQueSaveResults(&quot;comet stats&quot;); This step will read the ImageJ results table and store it in BisQue under the given name. It will be linked in the output section of the current MEX (module execution) document. The completed macro is now as follows: BisQueLoadImage(); run(&quot;Set Measurements...&quot;, &quot;centroid center integrated redirect=None decimal=3&quot;); setFont(&quot;SansSerif&quot;, 18); setColor(255, 255, 255); BisQueLoadPolygon(&quot;head&quot;); run(&quot;Measure&quot;); BisQueLoadPolygon(&quot;tail&quot;); run(&quot;Measure&quot;); i = nResults -1; tailx = getResult(&quot;XM&quot;, i); headx = getResult(&quot;X&quot;, i-1); taily = getResult(&quot;YM&quot;, i); heady = getResult(&quot;Y&quot;, i-1); tailden = getResult(&quot;RawIntDen&quot;,i); headden = getResult(&quot;RawIntDen&quot;,i-1); CometLen = sqrt( ((tailx-headx)* (tailx-headx)) + ((taily-heady)*(taily-heady)) ); setResult(&quot;TailLen&quot;,i,(CometLen)); setResult(&quot;TailMoment&quot;,i , (CometLen * tailden)); setResult(&quot;%TailDNA&quot;,i ,(tailden/(tailden + headden))*100); updateResults(); BisQueSaveResults(&quot;comet stats&quot;); After uploading this macro again, all boxes are either green or blue, indicating the pipeline is now valid for execution. Running an ImageJ Macro ImageJ macros can be run like any other BisQue module. First, select the macro to run (in this example, we select the CometAssay macro. After viewing the pipeline, click on “Analyze” and then on “ImageJ”. The ImageJ module page opens. Click “Select an Image” to choose a single image to run the macro on (alternatively, a dataset of images can be selected to run the macro on multiple images in parallel): ImageJ Pipeline Note that the selected image(s) need to have at least two polygon Gobjects: one with semantic type “head” and one with semantic type “tail”. Finally, click the “Run” button to start the macro execution. Once the execution finishes, the outputs are shown in section 4: ImageJ Pipeline In this case, one table “comet stats” was generated. It contains the comet statistics computed in the macro. Depending on the macro, images or Gobjects can also be generated as output (see next section). The generated tables can now be processed further in additional BisQue modules or shared with other users. Special BisQue extensions for ImageJ There are several BisQue-specific extensions to ImageJ to allow ImageJ macros to interact with the BisQue system. Each one is described in the following. BisQueLoadImage() This function corresponds to the open() function of ImageJ. Instead of opening an image from a file, however, it obtains the image from the BisQue module executor. The opened image is one of the images from the module input section. BisQueLoadPolygon(&quot;gobject type&quot;) This function loads a polygon Gobject from the current image into ImageJ as a selection for further processing in the macro. The “gobject type” parameter is used to select a specific Gobject with the semantic type “gobject type”. In other words, the current image has to have a Gobject as follows: &lt;gobject type=&quot;gobject type&quot;&gt; &lt;polygon&gt; &lt;vertex index=&quot;0&quot; t=&quot;0.0&quot; x=&quot;735.0&quot; y=&quot;617.0&quot; z=&quot;0.0&quot;/&gt; ... &lt;vertex index=&quot;10&quot; t=&quot;0.0&quot; x=&quot;727.0&quot; y=&quot;624.0&quot; z=&quot;0.0&quot;/&gt; &lt;/polygon&gt; &lt;/gobject&gt; This can be generated for example via the graphical annotations tool in the BisQue image viewer. BisQueSaveImage(&quot;image name&quot;) This function corresponds to the saveAs(\"Tiff\", ...) function of ImageJ. Instead of saving the image to a file, however, it stores the image back into BisQue as a new image resource. The created image is then referenced in the MEX (module execution) document’s output section. BisQueSaveROIs(&quot;polygon&quot;, &quot;label&quot;, &quot;color&quot;) This function stores the current ImageJ ROIs as polygon Gobjects in the output section of the current MEX (module execution) document. Each polygon is assigned the provided label and color. BisQueAddTag(&quot;tag_name&quot;, &quot;tag_value&quot;) This function adds a tag/value pair to the output section of the current MEX (module execution) document. BisQueSaveResults() This function stores the current ImageJ result table as a table resource in BisQue. The created table is then referenced in the MEX (module execution) document’s output section. "],["cellprofiler-module.html", "1.6 CellProfiler Module", " 1.6 CellProfiler Module Overview The CellProfiler module allows to execute arbitrary CellProfiler pipelines on single images or datasets of images. Pipeline parameters can be changed and parameter value lists can be provided to experiment with parameter variations. The results are stored back in BisQue as Gobjects, tables, or images. Uploading of CellProfiler Pipelines Most CellProfiler pipelines can be uploaded and used directly without modifications. In order to upload a pipeline, click Upload, select the pipeline file, and click Upload. If the file extension is .cp or .cppipe, the file will automatically be recognized as a CellProfiler pipeline. In order to verify the pipeline, it can be opened by browsing the cellprofiler_pipeline resources and opening the recently uploaded pipeline. It will look like this: ImageJ Pipeline Each box represents one CellProfiler module and the arrows indicate the pipeline flow through the modules. Note that some boxes have different colors. For example, the first box (BisQueLoadImages) is shown in blue to indicate that the original module(s) from the pipeline have been replaced with a BisQue specific component that allows to read images directly from BisQue. These pipeline conversions happen automatically when the pipeline is uploaded into BisQue. The next three steps in the pipeline are shown in transparent color to indicate that they were inactivated. Certain operations (such as Crop in this example) are not currently compatible with BisQue and are ignored without affecting the rest of the pipeline. Green boxes indicate regular CellProfiler modules that were kept unchanged. Red boxes indicate incompatible operations that could not be modified and will render the pipeline non-executable. The pipeline can be modified to replace the operations in red with other steps and the pipeline re-uploaded to fix this problem. Running a CellProfiler Pipeline In order to demonstrate how to run a CellProfiler pipeline, open the ExampleFly.cppipe pipeline that can be found in the public Fly dataset inside the CellProfiler Examples dataset (please ensure to check Show public data in the options menu on the top right; otherwise, you will not see these resources): ImageJ Pipeline After viewing the pipeline, click on Analyze and then on CellProfiler: ImageJ Pipeline The CellProfiler module page opens. Click Select an Image to choose a single image to run the pipeline on (alternatively, a dataset of images can be selected to run the pipeline on multiple images in parallel): ImageJ Pipeline For this example, we use the image CPExample Fly1. Note that the pipeline expects a three-channel image as input (this can be seen in the BisQueLoadImages step at the beginning of the pipeline). Next, modify any pipeline parameters if desired in section 2 (the values shown are the defaults found in the pipeline). Besides single parameters, this module also allows lists of parameters to be entered. For example, for Size of smoothing filter, one can enter \\([10,20,30]\\) to run the pipeline with all three smoothing filter settings in parallel. This allows to study the effect of this parameter on the final output. Finally, click the Run button to start the pipeline execution. Results Once the execution finishes, the pipeline outputs are shown in section 4: ImageJ Pipeline In this case, one image and one table are generated. Additionally, Gobjects are created by a BisQue specific pipeline step BisQueExtractGObjects towards the end of the pipeline. This step reads certain columns from a generated table and interprets them as GObject parameters (in this case, ellipse coordinates and minor/major axis). The generated GObjects are stored as part of the Mex document, as with any other module. In order to view the Gobjects, open the input image (CPExample Fly1) again and under the Graphical tab, check the top-most CellProfiler line (representing the last module run). This displays three types of ellipses overlayed over the image, one for detected nuclei, one for the cell boundaries, and one for the detected locations of cytoplasm: ImageJ Pipeline The GObjects were generated by the three BisQueExtractGObjects steps at the end of the pipeline, one for objects from the “Nuclei” table, one for objects from the “Cells” table, and one for objects from the Cytoplasm table. The colors were set in these steps as red, green, and blue respectively. By hovering with the mouse pointer over any of the Gobjects, additional statistics are displayed. The generated tables and Gobjects can now be processed further in additional BisQue modules or shared with other users. "],["plant-cell-segmentation.html", "1.7 Plant Cell Segmentation", " 1.7 Plant Cell Segmentation Overview This module is for segmenting 3D membrane tagged cell images. The workflow is as follows: 3D UNet to output the probability map of a cell boundary, 3D watershed to get the initial cell label, and 3D Conditional Random Field (CRF) to refine the segmentation label. CellECT 2.0 Module Homepage Using the Analyze tab on BisQue, you should see the Cell Segmentation 3D UNET module. Click on it and you should see a landing page like this. CellECT 2.0 Module Homepage. Here is the landing page for the GPU-enabled CellECT 2.0 module. Algorithm Workflow Diagram By using 3D UNET on the backend, we are able to segment the 3D volumes of the cells. We then create the segmentation map and use a Conditional Random Field (CRF) to further refine the segmentation map. Lastly, we use the information from the algorithm to extract features about the cells such as volume, surface coordinates, and many others. CellECT 2.0 Workflow. The Plant Cell Segmentation Workflow from the algorithmic view. Module Integration Workflow The module workflow consists of a source code folder with information on how to run the algorithm. We can then Dockerize the source code folder using a base image that includes the necessary CUDA libraries and dependencies and beginning testing whther the source code runs inside the container. Thereafter, we deploy the module on BisQue for public usage. Module Integration Workflow. Workflow for integrating the Plant Cell Segmentation module. Input Sample Plant Cell Images. These images are taken from time series data stored in TIFF files. TIFF Image with minimum \\(z &gt; 1\\) Hyperparameters Threshold - The bilateral standard deviation (threshold) for CRF define how much intensity-homogeneity is required within a region. Higher values allow greater variations under the same label. Label Threshold - The minimum possible volume of cells to avoid segmenting intercellular space as an individual cell. Minimum Distance - In the seeds detection for watershed, the minimum possible distance between two seeds. The lower the value is, the more likely to have over-segmentation. Minimum Cell Size - Minimum size to be considered a cell Cell Features Cell Number - The number of cells in each image stack. Cell Volume - The size of each cell in terms of number of voxels. Cell Center - The centroid of each cell. Cell Coordinates - The surface coordinate of each cell. Adjacency Table - The graph represents the neighbor of each cell 3-way Conjunction Points - The touch points of 3 neighboring cells Output Segmented TIFF Image HDF5 Table with Cell Features TABLE 1.1: Sample HDF5 Table with Cell Features CellNumber CellVolume CellCenter SegmentedImage SurfaceCoordinates 1 9832 [5, 57, 5] SEGMENTED TIFF as ARRAY ARRAY of Surface Coordinates 2 2387 [5, 87, 5] SEGMENTED TIFF as ARRAY ARRAY of Surface Coordinates 3 945 [5, 23, 5] SEGMENTED TIFF as ARRAY ARRAY of Surface Coordinates 4 2843 [5, 38, 5] SEGMENTED TIFF as ARRAY ARRAY of Surface Coordinates 5 1029 [5, 27, 5] SEGMENTED TIFF as ARRAY ARRAY of Surface Coordinates "],["nph-prediction.html", "1.8 NPH Prediction", " 1.8 NPH Prediction Overview This module is for segmenting a CT scan of a brain into 3 parts: lateral ventricles, cerebral matter, and subarachnoid space using a 3D UNet. A Support Vector Machine is then used to determine if the subject has possible Normal Pressure Hydrocephalus (NPH). NPH Prediction Module Homepage NPH Prediction Module Homepage. This is the landing for the NPH Prediction module on BisQue. Click Here to view! How to Run NPH Prediction Module STEP 1. Login From the BisQue Homepage, the top right-hand corner has the Sign In button. BisQue Homepage. The Red highlighting shows where to click. If you do not have an account, you can create one. If you already have an account, login using your credentials. There is even an option to reset your password just in case you forgot! STEP 2. Upload Image(s) BisQue supports many of the popular medical imaging file formats, i.e. NIFTI, DICOM. We will cover two of them here. Upload NIFTI Once logged in successfully, you will see Upload in the top menu bar. Click on Upload and feel free to Drag-and-Drop files or Select Choose Files or Choose Directory. Navigate to the NIFTI files on your computer and select the ones you want to upload, either individual files or an entire folder/directory. The supported NIFTI file types should end with .nii or .nii.gz. Example CT35000.nii.gz CT36000.nii YOUR-FILENAME.nii.gz Upload DICOM Once logged in successfully, you will see Upload in the top menu bar. Click on Upload and feel free to Drag-and-Drop files or Select Choose Files or Choose Directory. WARNING: DICOM FILES MUST BE ZIPPED! Before uploading your folder of DICOM files, make sure they are compressed/zipped. On Mac, two-finger click on the file and hit Compress YOUR-FOLDERNAME. This will zip the folder and allow you to upload that single zipped file to BisQue. We currently do not support uploading the raw directory to BisQue. Example Folder of Raw DICOM. IM-0001-0001-0001.dcm IM-0001-0001-0002.dcm IM-0002-0001.dcm IM-0002-0002.dcm IM-0002-0003.dcm IM-0002-0004.dcm IM-0002-0005.dcm IM-0002-0006.dcm IM-0002-0007.dcm IM-0002-0008.dcm IM-0002-0009.dcm IM-0002-0010.dcm IM-0002-0011.dcm IM-0002-0012.dcm IM-0002-0013.dcm [...] Zip the folder containing these files and you are good to go! Upload DICOM. Upload the zipped directory of DICOM files. Select the option that says Several DICOM files in a package (unpack and inspect). BisQue will correctly parse the DICOM files and upload them as dataset if there are multiple images. After its uploaded, you can click on the Blue Text to be taken to your uploaded files. STEP 3. Go To NPH Prediction Module Homepage Once you are logged in successfully, you can access the NPH Prediction module by Clicking Here or by using the Menu bar at the top of the homepage. From the Menu Bar. Using the Menu bar at the top of the screen, go to Analyze --&gt; NPH Prediction. You might have to scroll down a little bit since we are adding more modules. Analyze. Click on the NPH Prediction module. STEP 4. Run NPH Prediction Module Once on the NPH Prediction homepage, Select an image you uploaded Select file from PyTorch Model (Old or Young) Hit RUN! Analyze. Select and Image and Select a PyTorch Model. Output. A successful run should have an output similar to this. "]]
